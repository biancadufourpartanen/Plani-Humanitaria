\documentclass[]{article}

\usepackage{amsmath}
%\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{float}

%opening
\title{Emergencia en Níger}
\author{Grupo 14: Bianca Dufour \& William Hedén}

\begin{document}

\maketitle

\noindent Se trata del problema de determinar el esquema óptimo de ayudar la emergencia en Níger.
\section{Conjuntos}
\begin{align*}
	i,j&: \text{Ciudad}, \quad i=1,\dots,7\\
	k&: \text{Tipo de vehiculo}, \quad j=1, 2
\end{align*}

\section{Parámetros}
\begin{align*}
	av_i &: \text{Ayuda disponible en ciudad i}\\
	d_i &: \text{Demanda de ayuda en ciudad j}\\
	cota_k &: \text{Cota superior de k}\\
	cap_k &: \text{Capacidad de ayuda de vehiculo k}\\
	velv_k &: \text{Velocidad vehículo k}\\
	cf_k &: \text{Un coste fijo para la conducción con el coche k por kilometro.}\\
	cv &: \text{Un coste fijo para mover una unidad de carga por kilometro.}\\
	velc_{i,j} &: \text{Velocidad máximo en el camino entre ciudad i y j.}\\
	vav_{k,i} &: \text{Número de vehiculos k disponibles en ciudad i.}\\
	dist_{i,j} &: \text{Distancia entre la ciudad i y j en kilometros.}\\
	budget &: \text{El coste total no puede superar el presupuesto.}\\
	qglobal &: \text{Este dia solo podemos enviar una carga total de qglobal.}
\end{align*}

\section{Variables}
\begin{align*}
		X_{i,j,k} &: \text{Número de vehículos k que van entre ciudad i y j.}\\
		carga_{i,j,k} &: \text{Cantidad de carga que van entre ciudad i y j con vehículo k.}\\
		Y_{i,j,k} &=
		\begin{cases}
		1 & \quad \text{si vehículo tipo k va de ciudad i a j.} \\
		0 & \quad \text{si no}\\
		\end{cases}\\
		load_i &: \text{Cantidad de carga que se queda en ciudad i.}\\
		Time_i &: \text{Tiempo en llegar a ciudad i.}\\ \\
		Coste &: \text{Coste total del ayuda a Níger.}\\
		Equidad &: \text{La carga que se queda en ciudad i dividido por la demanda de ciudad i.}\\
		Tiempo &: \text{El tiempo total del ayuda a Níger.}
\end{align*}

\section{Modelo}
Queremos hacer tres cosas en este modelo:
\begin{itemize}
	\item Minimizar el coste del ayuda total.
	\item Maximizar la equidad entre Agadez y Zinder.
	\item Minimizar el tiempo de hacer el operación.
\end{itemize}
Vamos a tratarlas una a una, y después resolvemos como un problema multiobjectivo por metas.

\begin{align*}
	\min \; & Coste = \sum_{i,j,k \mid dist_{i,j} > 0} dist_{i,j}\cdot (2\cdot X_{i,j,k}\cdot cf_{k}+cv\cdot carga_{i,j,k})\\
	\max \; & Equidad \leq  \frac{load_i}{d_i}, \quad \forall i \mid d_i > 0\\
	\min \; & Tiempo \geq Time_i, \quad \forall i \mid d_i > 0\\ \\
	\text{restricciónes:}&\\
	\forall j, \quad &\sum_{i,k \mid dist_{i,j} > 0} carga_{i,j,k} + av_j = \sum_{i,k \mid dist_{j,i} > 0}  carga_{j,i,k} + load_j\\
	\forall j,k, \quad &\sum_{i \mid dist_{i,j} > 0} X_{i,j,k} + vav_{k,j} \geq \sum_{i \mid dist_{j,i} > 0} X_{j,i,k}\\
	\forall j, \quad &load_j \leq d_j + av_j\\
	\forall j \mid d_j > 0, \quad &\sum_j load_j = qglobal\\
	\forall i,j,k \mid dist_{i,j} > 0, \quad & carga_{i,j,k} \leq cap_k \cdot X_{i,j,k}\\
	& Coste \leq budget\\
	\forall i,j,k \mid dist_{i,j} > 0, \quad & Time_j \geq Time_i + \frac{dist_{i,j}}{\min(velv_k, velc_{i,j})} - 10000\cdot (1-Y_{i,j,k})\\
	\forall i,j,k \mid dist_{i,j} > 0, \quad & X_{i,j,k} \leq cota_k \cdot Y_{i,j,k}
\end{align*}

\section{Solución}
En Table \ref{tab:dfdg} hemos resumido los resultados de los tres casos en el matriz de pagos. La letra A es para Agadez, y la letra Z es de Zinder.

\begin{table}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
$$ & Coste  &  Equidad A & Equidad Z & Tiempo A (h) & Tiempo Z (h) \\ \hline
  Min Coste  & 65579.1667 &    0.2667  &   1   &  127.25 & 116.25  \\
  Max Equidad  &  80000.0 &   0.4762  &   0.4762  &  127.25 & 116.25  \\
  Min Tiempo  &  78018.75 &     0.2667  &   1   &  94.25 & 83.25  \\
\hline
\end{tabular}
\caption{Matriz de pagos}
\label{tab:dfdg}
\end{center}
\end{table}



\section{Programación por metas}
Ahora queremos encontrar una solución multiobjetivo donde el coste debe ser menor o igual a 80 000 euros, el tiempo menor o igual que un tiempo T, y la equidad debe ser major o igual que 0. Elegimos el tiempo mas grande de la matriz de pago para el valor de T. Entonces, tenemos:\\

\begin{center}
$
\begin{cases}
Coste + n_1 - p_1 = 80 000 \\
Time + n_2 - p_2 = T \\
Equidad+ n_3 - p_3 = 0\\
\end{cases}
$
\end{center}

\noindent Donde 
\begin{align*}
& p_1 = \text{cantidad arriba de 80 000} \\
& p_2 = \text{tiempo arriba de T} \\
& n_3 = \text{cantidad debajo de 0} \\
\end{align*}

\noindent La equidad es definida por ser siempre major o igual a 0, entonces solo queremos minimizar $p_1 + p_2$, sin $n_3$. El modelo que ahora tenemos es:

\begin{align*}
&\min (p_1+p_2) \\
\text{s.a.} \\
& Coste + n_1 - p_1 = 80 000 \\
&Tiempo + n_2 - p_2 = 127.25 \\
&Equidad+ n_3 - p_3 = 0\\
\end{align*}

\noindent con Coste, Tiempo y Equidad definen como está escrito arriba. Resolvemos en GAMS con todas las restricciones, obtenemos los siguientes resultados:

\begin{table}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
Coste & 71169.1667\\
\hline
Equidad Z & 1\\
Equidad A & 0.2667\\
\hline
Tiempo Z & 116.25 \\
Tiempo A & 126.25 \\
\hline
$n_1$ & 8830.8333 \\
$n_2$ & 0\\
$n_3$ & 0\\
\hline
$p_1$ & 0\\
$p_2$ & 0\\
$p_3$ & 0.2667\\
\hline
\end{tabular}
\caption{Resultados con modelo de metas.}
\label{tab:metas}
\end{center}
\end{table}

\noindent Podemos ver que el el modelo con metas tenemos la misma equidad y tiempo como en el modelo de minimizar el coste, pero el coste es mas! Que pasó? Si nos fijamos en el archivo .lst en GAMS, podemos ver que en este último modelo de los coches toman otra ruta en comparación con aquella en la que se minimiza el coste.

\section{Codigo GAMS}



\end{document}
